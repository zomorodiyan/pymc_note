import numpy as np
import matplotlib.pyplot as plt
def f(t,c,phi): return np.sin(c*t+phi)
plt.rc('font', size=13)

fn1 = np.load('./dat/fn1.npy')
fn2 = np.load('./dat/fn2.npy')
fn3 = np.load('./dat/fn3.npy')
fn4 = np.load('./dat/fn4.npy')
fs1 = np.load('./dat/fs1.npy')
fs2 = np.load('./dat/fs2.npy')
fs3 = np.load('./dat/fs3.npy')
fs4 = np.load('./dat/fs4.npy')

n = [10,20,40,100]
n1,n2,n3,n4=n

tn1 = np.linspace(0,1,n1)
tn2 = np.linspace(0,1,n2)
tn3 = np.linspace(0,1,n3)
tn4 = np.linspace(0,1,n4)

c_s_mc = np.array([2,1.99,1.98,1.96])
p_s_mc = np.array([1.57,1.569,1.569,1.568])
c_n_mc = np.array([1.87,1.99,1.96,1.96])
p_n_mc = np.array([1.5704,1.5706,1.5707,1.5708])

c_s_en = np.array([1.98,1.96,1.953,1.94])
p_s_en = np.array([1.571,1.58,1.578,1.584])
c_n_en = np.array([1.7,1.95,1.88,1.97])
p_n_en = np.array([1.585,1.578,1.58,1.575])

c_s_fs = np.array([2,1.987,1.975,1.955])
p_s_fs = np.array([1.5707,1.5725,1.574,1.5758])
c_n_fs = np.array([1.89,1.94,1.93,1.955])
p_n_fs = np.array([1.579,1.574,1.5725,1.57])

s = np.array([0.0001,0.05,0.1,0.2])
s1,s2,s3,s4 = s
ts = tn4

fig, axs = plt.subplots(nrows=2, ncols=3,figsize=(16,9))
plt.rc('font', size=15)
fig.suptitle('various amount of noise($\sigma$): 0.00, 0.05, 0.10, 0.20')
axs[0, 0].plot(s,c_s_mc,'r',label='pymc')
axs[0, 0].plot(s,c_s_en,'b',label='EnKF')
axs[0, 0].plot(s,c_s_fs,'g',label='FSE')
axs[0, 0].plot(s,[2,2,2,2],'--k',label='true')
axs[0, 0].set_xlabel('$\sigma$')
axs[0, 0].set_ylabel('$c$')
axs[0, 0].legend()
axs[1, 0].plot(s,p_s_mc,'r')
axs[1, 0].plot(s,p_s_en,'b')
axs[1, 0].plot(s,p_s_fs,'g')
axs[1, 0].plot(s,[np.pi/2,np.pi/2,np.pi/2,np.pi/2],'--k')
axs[1, 0].set_xlabel('$\sigma$')
axs[1, 0].set_ylabel('$\phi$')
axs[0, 1].plot(ts, fs1,'.',label='observations')
axs[0, 1].plot(ts, f(ts,c_s_mc[0],p_s_mc[0]),'r',label='pymc')
axs[0, 1].plot(ts, f(ts,c_s_en[0],p_s_en[0]),'b',label='EnKF')
axs[0, 1].plot(ts, f(ts,c_s_fs[0],p_s_fs[0]),'g',label='FSE')
axs[0, 1].plot(ts, f(ts,2,np.pi/2),'--k',label='true')
axs[0, 1].set_xlabel('$t$')
axs[0, 1].set_ylabel('$f (t,c,\phi)$')
axs[0, 1].legend()
axs[0, 2].plot(ts, fs2,'.')
axs[0, 2].plot(ts, f(ts,c_s_mc[1],p_s_mc[1]),'r')
axs[0, 2].plot(ts, f(ts,c_s_en[1],p_s_en[1]),'b')
axs[0, 2].plot(ts, f(ts,c_s_fs[1],p_s_fs[1]),'g')
axs[0, 2].plot(ts, f(ts,2,np.pi/2),'--k')
axs[0, 2].set_xlabel('$t$')
axs[0, 2].set_ylabel('$f (t,c,\phi)$')
axs[1, 1].plot(ts, fs3,'.')
axs[1, 1].plot(ts, f(ts,c_s_mc[2],p_s_mc[2]),'r')
axs[1, 1].plot(ts, f(ts,c_s_en[2],p_s_en[2]),'b')
axs[1, 1].plot(ts, f(ts,c_s_fs[2],p_s_fs[2]),'g')
axs[1, 1].plot(ts, f(ts,2,np.pi/2),'--k')
axs[1, 1].set_xlabel('$t$')
axs[1, 1].set_ylabel('$f (t,c,\phi)$')
axs[1, 2].plot(ts, fs4,'.')
axs[1, 2].plot(ts, f(ts,c_s_mc[3],p_s_mc[3]),'r')
axs[1, 2].plot(ts, f(ts,c_s_en[3],p_s_en[3]),'b')
axs[1, 2].plot(ts, f(ts,c_s_fs[3],p_s_fs[3]),'g')
axs[1, 2].plot(ts, f(ts,2,np.pi/2),'--k')
axs[1, 2].set_xlabel('$t$')
axs[1, 2].set_ylabel('$f (t,c,\phi)$')
fig.tight_layout() #spacing between subplots
plt.savefig('./Plots/sigma_var.png')
plt.show()
s = np.array([0.0001,0.05,0.1,0.2])
s1,s2,s3,s4=s

fig, axs = plt.subplots(nrows=2, ncols=3,figsize=(16,9))
fig.suptitle('various number of observation: 10, 20, 40, 100')
axs[0, 0].plot(n,c_n_mc,'r',label='pymc')
axs[0, 0].plot(n,c_n_en,'b',label='EnKF')
axs[0, 0].plot(n,c_n_fs,'g',label='FSE')
axs[0, 0].plot(n,[2,2,2,2],'--k',label='true')
axs[0, 0].set_xlabel('$n_{obs}$')
axs[0, 0].set_ylabel('$c$')
axs[0, 0].legend()
axs[1, 0].plot(n,p_n_mc,'r')
axs[1, 0].plot(n,p_n_en,'b')
axs[1, 0].plot(n,p_n_fs,'g')
axs[1, 0].plot(n,[np.pi/2,np.pi/2,np.pi/2,np.pi/2],'--k')
axs[1, 0].set_xlabel('$n_{obs}$')
axs[1, 0].set_ylabel('$\phi$')
axs[0, 1].plot(tn1, fn1,'.',label='observations')
axs[0, 1].plot(tn1, f(tn1,c_n_mc[0],p_n_mc[0]),'r',label='pymc')
axs[0, 1].plot(tn1, f(tn1,c_n_en[0],p_n_en[0]),'b',label='EnKF')
axs[0, 1].plot(tn1, f(tn1,c_n_fs[0],p_n_fs[0]),'g',label='FSE')
axs[0, 1].plot(tn1, f(tn1,2,np.pi/2),'--k',label='true')
axs[0, 1].set_xlabel('$t$')
axs[0, 1].set_ylabel('$f (t,c,\phi)$')
axs[0, 1].legend()
axs[0, 2].plot(tn2, fn2,'.')
axs[0, 2].plot(tn2, f(tn2,c_n_mc[1],p_n_mc[1]),'r')
axs[0, 2].plot(tn2, f(tn2,c_n_en[1],p_n_en[1]),'b')
axs[0, 2].plot(tn2, f(tn2,c_n_fs[1],p_n_fs[1]),'g')
axs[0, 2].plot(tn2, f(tn2,2,np.pi/2),'--k')
axs[0, 2].set_xlabel('$t$')
axs[0, 2].set_ylabel('$f (t,c,\phi)$')
axs[1, 1].plot(tn3, fn3,'.')
axs[1, 1].plot(tn3, f(tn3,c_n_mc[2],p_n_mc[2]),'r')
axs[1, 1].plot(tn3, f(tn3,c_n_en[2],p_n_en[2]),'b')
axs[1, 1].plot(tn3, f(tn3,c_n_fs[2],p_n_fs[2]),'g')
axs[1, 1].plot(tn3, f(tn3,2,np.pi/2),'--k')
axs[1, 1].set_xlabel('$t$')
axs[1, 1].set_ylabel('$f (t,c,\phi)$')
axs[1, 2].plot(tn4, fn4,'.')
axs[1, 2].plot(tn4, f(tn4,c_n_mc[3],p_n_mc[3]),'r')
axs[1, 2].plot(tn4, f(tn4,c_n_en[3],p_n_en[3]),'b')
axs[1, 2].plot(tn4, f(tn4,c_n_fs[3],p_n_fs[3]),'g')
axs[1, 2].plot(tn4, f(tn4,2,np.pi/2),'--k')
axs[1, 2].set_xlabel('$t$')
axs[1, 2].set_ylabel('$f (t,c,\phi)$')
fig.tight_layout() #spacing between subplots
plt.savefig('./Plots/n_obs_var.png')
plt.show()

